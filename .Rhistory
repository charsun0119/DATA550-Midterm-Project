here::i_am("code/01_descriptive_stats.R")
data <- readRDS(
file = here::here("data/covid_data.rds")
)
head(covid_data)
here::i_am("code/00_dataset_rds.R")
covid_data <- read.csv("data/covid_sub.csv")
# Create variable tracking instances of death
covid_data$DEATH <- ifelse(is.na(covid_data$DATE_DIED), 0, 1)
saveRDS(
covid_data,
file = here::here("data/covid_data.rds")
)
here::i_am("code/01_descriptive_stats.R")
data <- readRDS(
file = here::here("data/covid_data.rds")
)
head(covid_data)
library(gtsummary)
library(dplyr)
# Create Bivariate Analysis Table using gtsummary
tbl <- covid_data %>%
select(DIABETES, DEATH, SEX, AGE, PREGNANT, COPD, ASTHMA, INMSUPR, HIPERTENSION, CARDIOVASCULAR, RENAL_CHRONIC, OTHER_DISEASE, INTUBED, ICU) %>%
tbl_summary(by = DIABETES, missing = "no",
label = list(
DEATH ~ "Death Instance",
SEX ~ "Gender",
AGE ~ "Age",
PREGNANT ~ "Pregnancy Status",
COPD ~ "COPD",
ASTHMA ~ "Asthma",
INMSUPR ~ "Immunosuppression",
HIPERTENSION ~ "Hypertension",
CARDIOVASCULAR ~ "Cardiovascular Disease",
RENAL_CHRONIC ~ "Chronic Renal Disease",
OTHER_DISEASE ~ "Other Disease",
INTUBED ~ "Intubation Done",
ICU ~ "ICU Placement")) %>%
add_p(test = everything() ~ "fisher.test",
test.args = everything() ~ list(simulate.p.value = TRUE))
saveRDS(
tbl,
file = here::here("output/table/table_one.rds")
)
knitr::opts_chunk$set(echo = TRUE)
# Printing the Descriptive Statistics table created by Katie (i.e., 01_descriptive_stats.R)
tab_1 <- readRDS(
file = here::here("output/table_one.rds")
)
# Printing the Descriptive Statistics table created by Katie (i.e., 01_descriptive_stats.R)
tab_1 <- readRDS(
file = here::here("output/table/table_one.rds")
)
tab_1
here::i_am("code/01_descriptive_stats.R")
data <- readRDS(
file = here::here("data/covid_data.rds")
)
head(covid_data)
library(gtsummary)
library(dplyr)
# Create Bivariate Analysis Table using gtsummary
tbl <- covid_data %>%
select(DIABETES, DEATH, SEX, AGE, PREGNANT, COPD, ASTHMA, INMSUPR, HIPERTENSION, CARDIOVASCULAR, RENAL_CHRONIC, OTHER_DISEASE, INTUBED, ICU) %>%
tbl_summary(by = DIABETES, missing = "no",
label = list(
DEATH ~ "Death Instance",
SEX ~ "Gender",
AGE ~ "Age",
PREGNANT ~ "Pregnancy Status",
COPD ~ "COPD",
ASTHMA ~ "Asthma",
INMSUPR ~ "Immunosuppression",
HIPERTENSION ~ "Hypertension",
CARDIOVASCULAR ~ "Cardiovascular Disease",
RENAL_CHRONIC ~ "Chronic Renal Disease",
OTHER_DISEASE ~ "Other Disease",
INTUBED ~ "Intubation Done",
ICU ~ "ICU Placement")) %>%
add_p(test = everything() ~ "fisher.test",
test.args = everything() ~ list(simulate.p.value = TRUE))
saveRDS(
tbl,
file = here::here("output/table_one.rds")
)
library(dplyr)
library(gtsummary)
library(here)
here::i_am("code/regression.R")
data <- read.csv(file = here::here("data/covid_sub.csv"))
data <- data %>%
mutate(death = case_when(
is.na(DATE_DIED) ~ 0,
TRUE ~ 1
))
data <- data %>%
mutate(classification = case_when(
CLASIFFICATION_FINAL == 1 ~ 1,
CLASIFFICATION_FINAL == 2 ~ 2,
CLASIFFICATION_FINAL == 3 ~ 3,
TRUE ~ 0
))
regression <- glm(death ~ DIABETES + AGE + SEX + classification, data = data,
family = binomial)
regression_table <- tbl_regression(
regression,
exponentiate = TRUE,
label = list(
DIABETES ~ "Diabetes",
SEX ~ "Sex",
AGE ~ "Age (years)",
classification ~ "COVID Classification"
)
)
saveRDS(regression_table, file =  here::here("output", "regression_table.rds"))
tab_2 <- readRDS(
file = here::here("output/regression_table.rds")
)
tab_2
View(regression_table)
View(regression_table)
View(regression)
View(regression_table)
View(tab_2)
here::i_am("code/02_regression.R")
here::i_am("code/02_regression.R")
library(dplyr)
library(gtsummary)
library(here)
here::i_am("code/02_regression.R")
data <- read.csv(file = here::here("data/covid_data.rds"))
data <- data %>%
mutate(death = case_when(
is.na(DATE_DIED) ~ 0,
TRUE ~ 1
))
library(dplyr)
library(gtsummary)
library(here)
here::i_am("code/02_regression.R")
data <- read.csv(file = here::here("data/covid_sub.csv"))
data <- data %>%
mutate(death = case_when(
is.na(DATE_DIED) ~ 0,
TRUE ~ 1
))
data <- data %>%
mutate(classification = case_when(
CLASIFFICATION_FINAL == 1 ~ 1,
CLASIFFICATION_FINAL == 2 ~ 2,
CLASIFFICATION_FINAL == 3 ~ 3,
TRUE ~ 0
))
regression <- glm(death ~ DIABETES + AGE + SEX + classification, data = data,
family = binomial)
regression_table <- tbl_regression(
regression,
exponentiate = TRUE,
label = list(
DIABETES ~ "Diabetes",
SEX ~ "Sex",
AGE ~ "Age (years)",
classification ~ "COVID Classification"
)
)
saveRDS(regression_table, file =  here::here("output", "regression_table.rds"))
here::i_am("code/03_make_bar.R")
data <- readRDS(
file = here::here("data/covid_data.rds"))
library(ggplot2)
bar <-
ggplot(
data,
mapping = aes(x = PATIENT_TYPE, fill = SEX)) +
geom_bar(position="fill") +
labs(
title = "Proportion of the Type of Care Patients Received by Sex",
x = "Patient Type",
y = "Proportion")
ggsave(
here::here("output/bar_graph.png"),
plot = bar,
device = "png")
knitr::opts_chunk$set(echo = TRUE)
bar_graph <- readPNG(
file = here::here("output/bar_graph.png")
)
#| fig.align = "center",
#| out.width = "600px"
knitr::include_graphics(
here::here("output", "bar_graph.png")
)
here::i_am("code/04_make_scatter.R")
data <- readRDS(
file = here::here("data/covid_data.rds"))
library(ggplot2)
regression <- glm(DEATH ~ DIABETES + AGE + SEX + CLASIFFICATION_FINAL,
data = data, family = binomial)
reg_data <- model.frame(regression)
reg_data$pred_prob <- predict(regression, type = "response")
reg_data <- reg_data[order(reg_data$pred_prob), ]
scatterplot <- ggplot(reg_data, aes(x = pred_prob, y = DEATH)) +
geom_jitter(height = 0.05, alpha = 0.3) +
stat_smooth(method = "glm", se = FALSE, color = "blue", linewidth = 1.2,
method.args = list(family=binomial)) +
labs(
x = "Predicted probability of death",
y = "Observed death (0/1)",
title = "Observed vs Predicted"
) +
theme_minimal()
ggsave(
here::here("output/scatterplot.png"),
plot = scatterplot,
device = "png")
#| fig.align = "center",
#| out.width = "600px"
knitr::include_graphics(
here::here("output", "scatterplot.png")
)
# Loading in the dataset based on Katie's changes (i.e., 00_dataset_rds.R)
here::i_am("final_report.Rmd")
data <- readRDS(
file = here::here("data/covid_data.rds")
)
# Printing the Descriptive Statistics table created by Katie (i.e., 01_descriptive_stats.R)
tab_1 <- readRDS(
file = here::here("output/table_one.rds")
)
install.packages(broom)
install.packages("broom")
installed.packages()
install.packages("broom.helpers")
renv::snapshot()
install.packages("broom")
install.packages("broom.helpers")
renv::snapshot()
renv::deactivate()
unlink("renv", recursive = TRUE)
renv::init()
renv::deactivate()
unlink("renv", recursive = TRUE)
renv::int()
renv::init()
renv::restore()
install.packages("broom")
install.packages("broom.helpers")
renv::init()
renv::snapshot()
names(renv::settings$package.dependencies())
renv::status()
lock <- renv::load_lockfile()
names(renv::manifest()$Packages)
install.packages("broom")
install.packages("broom.helpers")
renv::snapshot()
renv::status
renv.status()
renv::status()
renv::init()
renv
renv::init()
install.packages("renv")
renv::init()
knitr::opts_chunk$set(echo = TRUE)
library(here)
library(knitr)
library(broom)
install.packages("broom")
install.packages("broom.helpers")
knitr::opts_chunk$set(echo = TRUE)
library(here)
library(knitr)
library(broom)
library(broom.helpers)
install.packages("renv")
knitr::opts_chunk$set(echo = TRUE)
library(here)
library(knitr)
library(broom)
library(broom.helpers)
install.packages("renv")
renv::init()
